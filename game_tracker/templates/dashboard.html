<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Dashboard ‚Äî {{ user.username }}</title>

    <!-- CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body>

<div class="box">

    <!-- –í–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å -->
    <div class="nav-links">
        <a href="/">‚¨Ö –ù–∞ –≥–ª–∞–≤–Ω—É—é</a>
        <a href="{{ url_for('logout') }}">üö™ –í—ã–π—Ç–∏</a>
    </div>

    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
    <h1 class="glitch-title">
        üéÆ {{ user.username }}
    </h1>

    <p class="subtitle">
        –¢–≤–æ–π –ª–∏—á–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∏–≥—Ä
    </p>

    <!-- üîç –ü–æ–∏—Å–∫ –ø–æ —Å–≤–æ–µ–º—É —Å–ø–∏—Å–∫—É -->
    <div class="search-box">
        <input type="text"
               id="gameSearch"
               placeholder="üîç –ü–æ–∏—Å–∫ –∏–≥—Ä—ã –≤ —Ç–≤–æ—ë–º —Å–ø–∏—Å–∫–µ...">
    </div>

    <hr>

    <!-- ‚ûï –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä—ã -->
    <h2 class="section-title">‚ûï –î–æ–±–∞–≤–∏—Ç—å –∏–≥—Ä—É</h2>

    <form method="POST" class="form">
        <input type="hidden" name="action" value="search">

        <input type="text"
               name="title"
               placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏–≥—Ä—ã..."
               required>

        <select name="status">
            <option value="–ü—Ä–æ–π–¥–µ–Ω–æ">–ü—Ä–æ–π–¥–µ–Ω–æ</option>
            <option value="–î—Ä–æ–ø">–î—Ä–æ–ø</option>
            <option value="–í –æ—á–µ—Ä–µ–¥–∏">–í –æ—á–µ—Ä–µ–¥–∏</option>
        </select>

        <button type="submit">üîç –ù–∞–π—Ç–∏ –≤ Steam</button>
    </form>


    <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã Steam -->
    {% if steam_results %}
        <hr>
        <h2 class="section-title">üéÆ –ù–∞–π–¥–µ–Ω–æ –≤ Steam</h2>

        <ul class="game-list">
            {% for g in steam_results %}
                <li class="game-card">

                    <img src="{{ g.image_url }}" alt="cover">

                    <span class="game-title">{{ g.name }}</span>

                    <form method="POST">
                        <input type="hidden" name="action" value="add">

                        <input type="hidden" name="name" value="{{ g.name }}">
                        <input type="hidden" name="appid" value="{{ g.appid }}">
                        <input type="hidden" name="image_url" value="{{ g.image_url }}">
                        <input type="hidden" name="status"
                               value="{{ chosen_status or '–ü—Ä–æ–π–¥–µ–Ω–æ' }}">

                        <button type="submit">‚ûï</button>
                    </form>

                </li>
            {% endfor %}
        </ul>
    {% endif %}
	
	<hr>

<!-- üì¶ –ü–µ—Ä–µ–Ω–æ—Å –∏–≥—Ä -->
<h2 class="section-title">üì¶ –ü–µ—Ä–µ–Ω–æ—Å –∏–≥—Ä</h2>

<p class="subtitle">
    –í—Å—Ç–∞–≤—å —Å–ø–∏—Å–æ–∫ –∏–≥—Ä —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é –∏–ª–∏ —á–µ—Ä–µ–∑ –∫–∞–∂–¥—É—é —Å—Ç—Ä–æ—á–∫—É, –∏ –æ–Ω–∏ –¥–æ–±–∞–≤—è—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
</p>

<form method="POST" class="form">
    <input type="hidden" name="action" value="bulk_add">

    <textarea name="titles"
              rows="3"
              placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: GTA V, Cyberpunk 2077, Red Dead Redemption 2"
              required></textarea>

    <select name="status">
        <option value="–ü—Ä–æ–π–¥–µ–Ω–æ">–ü—Ä–æ–π–¥–µ–Ω–æ</option>
        <option value="–î—Ä–æ–ø">–î—Ä–æ–ø</option>
        <option value="–í –æ—á–µ—Ä–µ–¥–∏">–í –æ—á–µ—Ä–µ–¥–∏</option>
    </select>

    <button type="submit">üöÄ –î–æ–±–∞–≤–∏—Ç—å –≤—Å–µ</button>
</form>


    <hr>

    <!-- ‚úÖ –ü–†–û–ô–î–ï–ù–û -->
    <h2 class="section-title">
        ‚úÖ –ü—Ä–æ–π–¥–µ–Ω–æ ({{ done_games|length }})
    </h2>

    <ul class="game-list">
        {% for game in done_games %}
            <li class="game-card game-item">

                {% if game.image_url %}
                    <img src="{{ game.image_url }}" alt="–û–±–ª–æ–∂–∫–∞">
                {% else %}
                    <div class="no-cover">No Cover</div>
                {% endif %}

                <span class="game-title">{{ game.title }}</span>

                <a class="delete-btn"
                   href="{{ url_for('delete_game', game_id=game.id) }}">‚úñ</a>

            </li>
        {% else %}
            <li class="empty">–ù–µ—Ç –∏–≥—Ä</li>
        {% endfor %}
    </ul>

    <hr>

    <!-- ‚ùå –î–†–û–ü -->
    <h2 class="section-title">
        ‚ùå –î—Ä–æ–ø ({{ drop_games|length }})
    </h2>

    <ul class="game-list">
        {% for game in drop_games %}
            <li class="game-card game-item">

                {% if game.image_url %}
                    <img src="{{ game.image_url }}" alt="–û–±–ª–æ–∂–∫–∞">
                {% else %}
                    <div class="no-cover">No Cover</div>
                {% endif %}

                <span class="game-title">{{ game.title }}</span>

                <a class="delete-btn"
                   href="{{ url_for('delete_game', game_id=game.id) }}">‚úñ</a>

            </li>
        {% else %}
            <li class="empty">–ù–µ—Ç –∏–≥—Ä</li>
        {% endfor %}
    </ul>

    <hr>

    <!-- ‚è≥ –û–ß–ï–†–ï–î–¨ -->
    <h2 class="section-title">
        ‚è≥ –í –æ—á–µ—Ä–µ–¥–∏ ({{ queue_games|length }})
    </h2>

    <ul class="game-list">
        {% for game in queue_games %}
            <li class="game-card game-item">

                {% if game.image_url %}
                    <img src="{{ game.image_url }}" alt="–û–±–ª–æ–∂–∫–∞">
                {% else %}
                    <div class="no-cover">No Cover</div>
                {% endif %}

                <span class="game-title">{{ game.title }}</span>

                <a class="delete-btn"
                   href="{{ url_for('delete_game', game_id=game.id) }}">‚úñ</a>

            </li>
        {% else %}
            <li class="empty">–û—á–µ—Ä–µ–¥—å –ø—É—Å—Ç–∞</li>
        {% endfor %}
    </ul>

</div>


<!-- üîç –ü–æ–∏—Å–∫ –ø–æ —Å–ø–∏—Å–∫—É -->
<script>
    const searchInput = document.getElementById("gameSearch");

    searchInput.addEventListener("keyup", function () {

        let filter = searchInput.value.toLowerCase();
        let games = document.querySelectorAll(".game-item");

        games.forEach(function (game) {
            let title = game.innerText.toLowerCase();

            if (title.includes(filter)) {
                game.style.display = "flex";
            } else {
                game.style.display = "none";
            }
        });

    });
</script>

</body>
</html>
